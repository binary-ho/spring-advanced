# 스프링이 제공하는 빈 후처리기
스프링에선 편하게 사용할 수 있는 빈 후처리기를 제공해준다.
아래 한 줄만 추가하면 된다.

```groovy
    dependencies {
        implementation 'org.springframework.boot:spring-boot-starter-aop'
    }
```

<br>


이 한줄만으로 AnnotationAwareAspectJAutoProxyCreator라는 빈 후처리기가 스프링 빈에 자동으로 등록된다. <br>
이름 그대로 자동으로 프록시를 생성해주는 빈 후처리기이다. (-> AutoProxyCreator) <br>
이 빈 후처리기가 스프링 빈으로 등록된 Advisor들을 자동으로 찾아 프록시가 필요한 곳에 자동으로 적용해준다. <br>
Adivsor 안에 Pointcut과 Advice가 이미 모두 포함되어 있다. <br>
Advisor만 알고 있으면, 그 안의 Pointcut으로 어떤 스프링 빈에 프록시를 저용해야 할지 알 수 있다. <br>

<br>

중요: 포인트컷은 2가지에사용된다. (강의록을 그대로 적음)

### 1. 프록시 적용 여부 판단 - 생성 단계
자동 프록시 생성기는 포인트컷을 사용해서 해당 빈이 프록시를 생성할 필요가 있는지 없는지 체크한다. <br>
클래스 + 메서드 조건을 모두 비교한다. <br> 

이때 모든 메서드를 체크하는데, 포인트컷 조건에 하나 하나 매칭해본다. <br> 
만약 조건에 맞는 것이 하나라도 있으면 프록시를 생성한다. <br>

예) orderControllerV1은 request(), noLog()가 있다. <br>


여기에서 request()가 조건에 만족하므로 프록시를 생성한다. <br>
만약 조건에 맞는 것이 하나도 없으면 프록시를 생성할 필요가 없으므로 프록시를 생성하지 않는다. -> 쏘 스마트 

### 2. 어드바이스 적용 여부 판단 - 사용 단계
프록시가 호출 되었을때 부가기능인 어드바이스를 적용할지 말지 포인트컷을 보고 판단한다. <br> 
앞서 설명한 예에서 orderControllerV1은 이미 프록시가 걸려있다. <br>
orderControllerV1의 request()는 현재 포인트컷 조건에 만족하므로 프록시는 어드바이스를 먼저 호출하고, target을 호출한다. <br>

orderControllerV1의 noLog()는 현재 포인트컷 조건에 만족하지 않으므로 어드바이스를 호출하지 않고 바로 target만 호출한다. <br>
당연하지만 프록시를 모든 곳에 생성하는 것은 비용 낭비이다. <br> 
꼭 필요한 곳에 최소한의 프록시를 적용해야 한다. <bn> 
그래서 자동 프록시 생성기는 모든 스프링빈에 프록시를 적용하는 것이 아니라 포인트컷으로 한번 필터링 해서 <Br> 
어드바이스가 사용될 가능성이 있는 곳에만 프록시를 생성한다. <br>


## 2. 다수의 어드바이저의 포인트 컷을 만족하면 프록시 자동 생성기는 어떻게 대응할까
다수의 어드바이저의 포인트 컷을 만족하면 프록시 자동 생성기는 어떻게 대응할까 <br>
프록시를 1개만 만들어 낸다. <br>
어차피 프록시 팩토리가 생성하는 프록시는 내부에 여러 advisor를 포함할 수 있기 때문이다. <Br>
하나도 만족하지 않으면 당연히 만들지도 않는다. <br>

참고로 스프링 AOP도 같은 방식으로 동작한다
